[parsing]
"{station_id}" = "16"

[localization]
timezone = "UTC+02:00"

[[redis.servers]]
name = "local.1"
host = "10.40.0.87"
#host = "192.168.11.243"
port = 6300

[[redis.servers]]
name = "remote.1"
host = "10.40.0.77"
port = 7000

[[redis.stream.producers]]
name = "stationlog"
target_server = "local.1"
stream_key = "station:{station_id}"
stream_size = 1000000 # producer only. '-1' to ignore

[[redis.stream.consumers]]
name = "commandlog"
source_server = "remote.1"
stream_key = "station:{station_id}:commands"

[[redis.stream.consumers]]
name = "commands_local"
source_server = "local.1"
stream_key = "station:{station_id}:commands"

[[redis.caches]]
name = "modbuscache"
target_server = "local.1"
index_key = "station:{station_id}:index"
filter = "modbusfilter"
consumers = [ "stationlog" ]

[websocket_server]
port = 1234

[modbus]
poll_rate = 500
response_time = 150 # ms
retries = 0
byteorder = "BigEndian" # { "BigEndian" | "LittleEndian" }
wordorder = "BigEndian" # { "BigEndian" | "LittleEndian" }
producers = [ "commandlog", "commands_local" ]
consumers = [ "modbuscache" ]

[[modbus.channel]]
    name = "spk"
    type = "master" # { "master" | "slave" }
    #slave_address = 10 # slave mode only
    
    [[modbus.channel.slaves]]
    address = 255
    source = "tcp.1" # modbus.rtu.devices.name OR modbus.tcp.devices.name
    registers = [ "station.*", "polder.*" ]
    queries = [ { reg_index = 0, reg_count = 50, type = "input" },
                { reg_index = 50, reg_count = 42, type = "input" },
                { reg_index = 0, reg_count = 50, type = "holding", poll_rate = 3000 } ]

[modbus.tcp]
    [[modbus.tcp.devices]]
    name = "tcp.1"
    ip = "10.40.0.66"
    port = 502
    
[log_debug]
modbus = true
mysql = false
